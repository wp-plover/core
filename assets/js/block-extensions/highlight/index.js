(()=>{"use strict";const e=window.React,t=window.wp.hooks,l=window.plover.utils,n=window.wp.blockEditor,i=window.wp.element,r=window.wp.richText,o=({attributes:o,...a})=>{const g=(0,i.useRef)(null),s=(0,t.applyFilters)("plover.highlight.previewWrapProps",(0,n.useBlockProps)({className:(0,t.applyFilters)("plover.highlight.previewClassnames",{[`plover-prism prism-${o.theme}-theme`]:!0,[`language-${o.language}`]:!0},o)}),o);return(0,i.useEffect)((()=>{g&&g.current&&window.Prism&&window.Prism.highlightElement(g.current,!1)}),[g,o?.content,o.theme]),(0,t.applyFilters)("plover.highlight.previewBlockEdit",(0,e.createElement)("pre",{...s},(0,e.createElement)("code",{ref:g},(0,l.isString)(o?.content)?(0,e.createElement)(i.RawHTML,null,o?.content):(0,r.getTextContent)(o?.content))),{attributes:o,blockWrapProps:s,...a})};function a({BlockEdit:t,...l}){const{attributes:i}=l,r=(0,n.useBlockProps)().className.split(" ").filter((e=>e.startsWith("align"))).join(" ");return(0,e.createElement)("div",{className:`prism-${i.theme}-theme ${r}`},(0,e.createElement)(t,{...l}))}const g=window.wp.components,s=window.wp.i18n,h=({attributes:i,setAttributes:r})=>{const o=(0,e.createElement)(e.Fragment,null,(0,e.createElement)(g.__experimentalToggleGroupControl,{isBlock:!0,label:(0,s.__)("Style","plover"),value:i.highlight,onChange:e=>{r({highlight:e})}},(0,e.createElement)(g.__experimentalToggleGroupControlOption,{value:"highlight",label:(0,s.__)("Highlight","plover")}),(0,e.createElement)(g.__experimentalToggleGroupControlOption,{value:"none",label:(0,s.__)("None","plover")})),"highlight"===i.highlight&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(g.SelectControl,{label:(0,s.__)("Theme","plover"),value:i.theme,options:(0,l.getExtensionSetting)("highlight","support_themes",[]),onChange:e=>r({theme:e}),__nextHasNoMarginBottom:!0}),(0,e.createElement)(g.SelectControl,{label:(0,s.__)("Language","plover"),value:i.language,options:(0,l.getExtensionSetting)("highlight","support_languages",[]),onChange:e=>r({language:e}),__nextHasNoMarginBottom:!0})));return(0,e.createElement)(n.InspectorControls,null,(0,e.createElement)(g.PanelBody,null,(0,t.applyFilters)("plover.highlight.InspectorControls",o,i,r)))},c={highlight:{type:"string",default:"highlight"},theme:{type:"string",default:"github-copilot"},language:{type:"string",default:"clike"}};(0,t.addFilter)("blocks.registerBlockType","plover/highlight-attributes",((e,t)=>("core/code"===t&&(e.attributes={...e.attributes,...(0,l.getExtensionSetting)("highlight","attributes",c)}),e))),(0,t.addFilter)("editor.BlockEdit","plover/highlight-controls",(t=>l=>{const{attributes:n,isSelected:i,name:r}=l;return"core/code"!==r?(0,e.createElement)(t,{...l}):(0,e.createElement)(e.Fragment,null,"none"===n.highlight?(0,e.createElement)(t,{...l}):i?(0,e.createElement)(a,{BlockEdit:t,...l}):(0,e.createElement)(o,{...l}),(0,e.createElement)(h,{...l}))}))})();