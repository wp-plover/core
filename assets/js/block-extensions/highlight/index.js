(()=>{"use strict";const e=window.React,t=window.wp.hooks,l=window.plover.utils,n=window.wp.blockEditor,r=window.wp.element,o=window.wp.richText,i=({attributes:i,...a})=>{const s=(0,r.useRef)(null),g=(0,t.applyFilters)("plover.highlight.previewWrapProps",(0,n.useBlockProps)({className:(0,t.applyFilters)("plover.highlight.previewClassnames",{[`plover-prism prism-${i.theme}-theme`]:!0,[`language-${i.language}`]:!0},i)}),i);return(0,r.useEffect)((()=>{s&&s.current&&window.Prism&&window.Prism.highlightElement(s.current,!1)}),[s,i?.content,i.theme]),(0,t.applyFilters)("plover.highlight.previewBlockEdit",(0,e.createElement)("pre",{...g},(0,e.createElement)("code",{ref:s},(0,l.isString)(i?.content)?(0,e.createElement)(r.RawHTML,null,i?.content):(0,o.getTextContent)(i?.content))),{attributes:i,blockWrapProps:g,...a})};function a({BlockEdit:t,...l}){const{attributes:r}=l,o=(0,n.useBlockProps)().className.split(" ").filter((e=>e.startsWith("align"))).join(" ");return(0,e.createElement)("div",{className:`prism-${r.theme}-theme ${o}`},(0,e.createElement)(t,{...l}))}const s=window.wp.components,g=window.wp.i18n,h=window.plover.components,p=({attributes:r,setAttributes:o})=>{const i=(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.__experimentalToggleGroupControl,{isBlock:!0,label:(0,g.__)("Style","plover"),value:r.highlight,onChange:e=>{o({highlight:e})}},(0,e.createElement)(s.__experimentalToggleGroupControlOption,{value:"highlight",label:(0,g.__)("Highlight","plover")}),(0,e.createElement)(s.__experimentalToggleGroupControlOption,{value:"none",label:(0,g.__)("None","plover")})),"highlight"===r.highlight&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.SelectControl,{label:(0,g.__)("Theme","plover"),value:r.theme,options:(0,l.getExtensionSetting)("highlight","support_themes",[]),onChange:e=>o({theme:e}),__nextHasNoMarginBottom:!0}),(0,e.createElement)(s.SelectControl,{label:(0,g.__)("Language","plover"),value:r.language,options:(0,l.getExtensionSetting)("highlight","support_languages",[]),onChange:e=>o({language:e}),__nextHasNoMarginBottom:!0})));return(0,e.createElement)(n.InspectorControls,null,(0,e.createElement)(s.PanelBody,null,(0,t.applyFilters)("plover.highlight.InspectorControls",i,r,o),!(0,l.is_premium)()&&(0,e.createElement)(h.Tips,null,(0,e.createElement)("p",{dangerouslySetInnerHTML:{__html:(0,g.sprintf)((0,g.__)("Upgrade to %s to access these features:","plover"),'<a href="'+(0,l.upsell_url)()+'">'+(0,g.__)("Premium","plover")+"</a>")}}),(0,e.createElement)("ul",null,(0,e.createElement)("li",null,(0,g.__)("Line numbers","plover")),(0,e.createElement)("li",null,(0,g.__)("Show languages","plover")),(0,e.createElement)("li",null,(0,g.__)("Show copy button","plover")),(0,e.createElement)("li",null,(0,g.__)("More highlight themes","plover"))),(0,e.createElement)("a",{href:"https://wpplover.com/docs/plover-kit/modules/code-highlight/",target:"_blank"},(0,g.__)("Learn More â†—","plover")))))},c={highlight:{type:"string",default:"highlight"},theme:{type:"string",default:"github-copilot"},language:{type:"string",default:"clike"}};(0,t.addFilter)("blocks.registerBlockType","plover/highlight-attributes",((e,t)=>("core/code"===t&&(e.attributes={...e.attributes,...(0,l.getExtensionSetting)("highlight","attributes",c)}),e))),(0,t.addFilter)("editor.BlockEdit","plover/highlight-controls",(t=>l=>{const{attributes:n,isSelected:r,name:o}=l;return"core/code"!==o?(0,e.createElement)(t,{...l}):(0,e.createElement)(e.Fragment,null,"none"===n.highlight?(0,e.createElement)(t,{...l}):r?(0,e.createElement)(a,{BlockEdit:t,...l}):(0,e.createElement)(i,{...l}),(0,e.createElement)(p,{...l}))}))})();