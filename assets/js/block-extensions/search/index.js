(()=>{"use strict";const e=window.React,t=window.wp.hooks,l=window.wp.blockEditor,o=window.wp.components,r=window.wp.i18n,a=window.wp.element,n=window.wp.data,s=window.plover.data;function p({postType:t,onChange:l}){const{postTypes:p}=(0,n.useSelect)((e=>{const{getPostTypes:t}=e(s.coreStore),l=["attachment"],o=t({per_page:-1})?.filter((({viewable:e,slug:t})=>e&&!l.includes(t)));return{postTypes:o}}),[]),c=(0,a.useMemo)((()=>[{label:(0,r.__)("All","plover"),value:""},...(p||[]).map((({labels:e,slug:t})=>({label:e.name,value:t})))]),[p]);return(0,e.createElement)(o.SelectControl,{label:(0,r.__)("Post Type","plover"),value:t,options:c,onChange:l})}function c(n){const{attributes:s,setAttributes:c}=n,{postType:i}=s,u=(0,t.applyFilters)("plover.searchFilters",[{attr:"postType",label:(0,r.__)("Post Type","plover"),isShownByDefault:!0,control:(0,e.createElement)(p,{postType:i,onChange:e=>{c({postType:e})}})}],n),[w,m]=(0,a.useState)({});return(0,e.createElement)(l.InspectorControls,null,(0,e.createElement)(o.__experimentalToolsPanel,{label:(0,r.__)("Filters","plover"),resetAll:()=>{m({})}},u.map((({attr:t,label:l,control:r,isShownByDefault:a})=>(0,e.createElement)(o.__experimentalToolsPanelItem,{key:t,hasValue:()=>!!w[t],label:l,onDeselect:()=>{m({...w,attr:void 0})},isShownByDefault:a||s[t]},r)))))}(0,t.addFilter)("blocks.registerBlockType","plover/search-attributes",((e,t)=>("core/search"===t&&(e.attributes={...e.attributes,postType:{type:"string"}}),e))),(0,t.addFilter)("editor.BlockEdit","plover/search-controls",(t=>l=>{const{attributes:o,isSelected:r,name:a}=l;return"core/search"!==a?(0,e.createElement)(t,{...l}):(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t,{...l}),(0,e.createElement)(c,{...l}))}))})();